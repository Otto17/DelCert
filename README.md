**DelCert** \- простая консольная программа для удаления сертификатов в Windows с автоматическим подтверждением всплывающих окон, тем самым полностью автоматизировав удаление сертификатов без ручных подтверждений.

Программа может работать как как самостоятельно, так и совместно с другим моим проектом DAVrun, ссылка на [GitHub](https://github.com/Otto17/DAVrun) и [GitFlic](https://gitflic.ru/project/otto/davrun).

_Данная программа является свободным программным обеспечением, распространяющимся по лицензии MIT._

---

_**Что может данная утилита:**_

*   Удалять любое количество сертификатов одной командой.
*   Для удаления сертификата можно использовать как общее имя "CN" (Common Name), так и серийный номер сертификата.
*   Поддерживается автоматическое подтверждение всплывающих окон при удалении сертификатов из  “Доверенные корневые центры сертификации” (Root) текущего пользователя.
*   Для корректного подтверждения всех всплывающих окон производится блокировка мыши и клавиатуры.
*   P.S. Для блокировки мыши и клавиатуры (во время подтверждения всплывающих окон) **программа должна быть запущена с правами администратора**!

---

_**Аргументы**_

```plaintext
DelCert.exe <CurrentUser или LocalMachine> <Название хранилища> <Сертификат_1> <Сертификат_2> ... <Сертификат_N>
```

**Примеры**:

```plaintext
DelCert "CurrentUser" "My" "TEST1"
DelCert "LocalMachine" "Root" "3b6300d6d6523e8d96738b3587303438cbf94936"
DelCert "LocalMachine" "CA" "TEST3" "TEST4"
DelCert "CurrentUser" "TrustedPeople" "TEST2" "46f1252342e07172fcd2ee27f0083b12ab99d68d" "TEST6"
```

_**Список названий хранилищ сертификатов:**_

```plaintext
"My"               - Личные
"Root"             - Доверенные корневые центры сертификации
"Trust"            - Доверительные отношения в предприятии
"CA"               - Промежуточные центры сертификации
"TrustedPublisher" - Доверенные издатели
"AuthRoot"         - Сторонние корневые центры сертификации
"TrustedPeople"    - Доверенные лица
"AddressBook"      - Другие пользователи
```

---

Для демонстрации сначала из папки “**ТЕСТ**” установите тестовый сертификат “**TEST.pfx**” (с цепочкой из 5 сертификатов)  в “**Доверенные корневые центры сертификации**” текущего пользователя, затем запустите от имени администратора самораспаковывающийся архив “**delete.exe**” (созданный через WinRAR).

И наблюдайте как происходит удаление с автоматическим подтверждением.

---

**Автор Otto, г. Омск 2024**
